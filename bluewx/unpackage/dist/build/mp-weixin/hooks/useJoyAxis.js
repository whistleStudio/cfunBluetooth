"use strict";var e=require("../common/vendor.js"),t=require("../utils/bt.js");exports.useJoyAxis=function(o){let r=0,a=0;const i=e.reactive({x:45,y:45,oldX:45,oldY:45,angle:0,isArrowShow:!1,joyOpacity:.3});function n(e,t){e-=45,t=45-t;let o=Math.abs(e),r=Math.abs(t),a=180*Math.atan(r/o)/Math.PI;switch(!0){case e>0&&t<0:i.angle=a;break;case e<0&&t>0:i.angle=180+a;break;case e<0&&t<0:i.angle=180-a;break;case e>0&&t>0:i.angle=360-a}}return{joySta:i,mvMove:function(e){let{x:a,y:s,source:l}=e.detail;i.oldX=a,i.oldY=s,"touch"===l&&(n(a,s),clearTimeout(r),r=setTimeout((()=>{let e=a/90*100,r=s/90*100;o[2]=r,o[3]=e;let i=new Uint8Array(o).buffer;console.log(i),t.bt.writeBuffer(i)}),200))},mvStart:function(){i.isArrowShow=!0,i.joyOpacity=1},mvRelease:function(){i.x=i.oldX,i.y=i.oldY,i.isArrowShow=!1,i.joyOpacity=.3,e.nextTick((()=>{i.x=45,i.y=45})),clearTimeout(a),a=setTimeout((()=>{o[2]=50,o[3]=50;let e=new Uint8Array(o).buffer;t.bt.writeBuffer(e)}),220)},arrowPos:n}};
